<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù„ÙˆØ­Ø© Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/daisyui@4.4.20/dist/full.min.css" rel="stylesheet" />
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <style>
        * { box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; transition: all 0.3s; }
        .fade-in { animation: fadeIn 0.5s ease-in; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .card-hover { transition: transform 0.2s, box-shadow 0.2s; }
        .card-hover:hover { transform: translateY(-5px); box-shadow: 0 8px 20px rgba(0,0,0,0.15); }
        .photo-circle { width: 100px; height: 100px; border-radius: 50%; object-fit: cover; border: 3px solid; }
        .modal-bg { position: fixed; inset: 0; background: rgba(0,0,0,0.6); z-index: 999; display: flex; align-items: center; justify-content: center; }
        .modal-box { max-width: 500px; width: 90%; max-height: 90vh; overflow-y: auto; }
    </style>
</head>
<body x-data="app()" x-init="init()" class="bg-base-100">

<!-- Navbar -->
<div class="navbar bg-primary text-primary-content shadow-lg sticky top-0 z-50">
    <div class="flex-1">
        <a class="btn btn-ghost text-xl">ğŸ‘¥ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</a>
    </div>
    <div class="flex-none gap-2">
        <button @click="toggleTheme()" class="btn btn-ghost btn-circle">
            <svg x-show="theme==='light'" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"/></svg>
            <svg x-show="theme==='dark'" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"/></svg>
        </button>
    </div>
</div>

<div class="container mx-auto p-4 max-w-6xl">
    <!-- Alert -->
    <div x-show="alert.show" x-transition class="alert shadow-lg mb-4" :class="alert.type === 'success' ? 'alert-success' : 'alert-error'">
        <span x-text="alert.message"></span>
    </div>

    <!-- Add User Section -->
    <div class="card bg-base-200 shadow-xl mb-6 fade-in">
        <div class="card-body">
            <h2 class="card-title text-2xl mb-4">â• Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªØ®Ø¯Ù…</h2>
            <div class="flex justify-center mb-4">
                <label class="cursor-pointer">
                    <input type="file" accept="image/*" @change="handlePhoto($event, 'new')" class="hidden">
                    <img x-show="newUser.preview" :src="newUser.preview" class="photo-circle border-primary">
                    <div x-show="!newUser.preview" class="photo-circle border-base-300 bg-base-300 flex items-center justify-center text-4xl">ğŸ“·</div>
                </label>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
                <input type="text" x-model="newUser.name" placeholder="Ø§Ù„Ø§Ø³Ù…" class="input input-bordered">
                <input type="email" x-model="newUser.email" placeholder="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ" class="input input-bordered">
                <input type="number" x-model="newUser.age" placeholder="Ø§Ù„Ø¹Ù…Ø±" class="input input-bordered">
            </div>
            <button @click="addUser()" class="btn btn-primary mt-3">â• Ø¥Ø¶Ø§ÙØ©</button>
        </div>
    </div>

    <!-- Search -->
    <div class="mb-6">
        <input type="text" x-model="search" placeholder="ğŸ” Ø§Ø¨Ø­Ø« Ø¹Ù† Ù…Ø³ØªØ®Ø¯Ù…..." class="input input-bordered w-full max-w-md mx-auto block">
    </div>

    <!-- Users Grid -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
        <template x-for="user in filtered()" :key="user.id">
            <div class="card bg-base-100 shadow-lg card-hover fade-in">
                <figure class="px-6 pt-6">
                    <img x-show="user.photo" :src="user.photo" class="w-full h-40 object-cover rounded-lg">
                    <div x-show="!user.photo" class="w-full h-40 bg-gradient-to-br from-primary/20 to-secondary/20 rounded-lg flex items-center justify-center text-5xl">ğŸ‘¤</div>
                </figure>
                <div class="card-body items-center text-center">
                    <h3 class="card-title" x-text="user.name"></h3>
                    <p class="text-sm opacity-70">ğŸ“§ <span x-text="user.email"></span></p>
                    <p class="text-sm opacity-70">ğŸ‚ <span x-text="user.age"></span> Ø³Ù†Ø©</p>
                    <div class="card-actions justify-center gap-2 mt-3 w-full">
                        <button @click="viewUser(user)" class="btn btn-info btn-sm flex-1">Ø¹Ø±Ø¶</button>
                        <button @click="editUser(user)" class="btn btn-warning btn-sm flex-1">ØªØ¹Ø¯ÙŠÙ„</button>
                        <button @click="deleteUser(user.id)" class="btn btn-error btn-sm flex-1">Ø­Ø°Ù</button>
                    </div>
                </div>
            </div>
        </template>
    </div>

    <!-- Empty State -->
    <div x-show="filtered().length === 0" class="text-center py-12">
        <div class="text-6xl mb-4">ğŸ”</div>
        <h3 class="text-2xl font-bold">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬</h3>
        <p class="opacity-70 mt-2">Ø¬Ø±Ø¨ Ø§Ù„Ø¨Ø­Ø« Ø¨ÙƒÙ„Ù…Ø§Øª Ø£Ø®Ø±Ù‰</p>
    </div>
</div>

<!-- Modal -->
<template x-if="modal.show">
    <div class="modal-bg" @click="closeModal()">
        <div class="modal-box bg-base-100 p-6 rounded-lg shadow-2xl" @click.stop>
            <h3 class="text-2xl font-bold mb-4" x-text="modal.title"></h3>
            <div class="flex justify-center mb-4">
                <template x-if="modal.edit">
                    <label class="cursor-pointer">
                        <input type="file" accept="image/*" @change="handlePhoto($event, 'edit')" class="hidden">
                        <img x-show="modal.user.preview || modal.user.photo" :src="modal.user.preview || modal.user.photo" class="photo-circle border-primary">
                        <div x-show="!modal.user.preview && !modal.user.photo" class="photo-circle border-base-300 bg-base-300 flex items-center justify-center text-4xl">ğŸ‘¤</div>
                    </label>
                </template>
                <template x-if="!modal.edit">
                    <img x-show="modal.user.photo" :src="modal.user.photo" class="photo-circle border-primary">
                    <div x-show="!modal.user.photo" class="photo-circle border-base-300 bg-base-300 flex items-center justify-center text-4xl">ğŸ‘¤</div>
                </template>
            </div>
            <div x-show="!modal.edit" class="space-y-2">
                <div class="p-3 bg-base-200 rounded"><strong>ğŸ†” Ø§Ù„Ù…Ø¹Ø±Ù:</strong> <span x-text="modal.user.id"></span></div>
                <div class="p-3 bg-base-200 rounded"><strong>ğŸ‘¤ Ø§Ù„Ø§Ø³Ù…:</strong> <span x-text="modal.user.name"></span></div>
                <div class="p-3 bg-base-200 rounded"><strong>ğŸ“§ Ø§Ù„Ø¨Ø±ÙŠØ¯:</strong> <span x-text="modal.user.email"></span></div>
                <div class="p-3 bg-base-200 rounded"><strong>ğŸ‚ Ø§Ù„Ø¹Ù…Ø±:</strong> <span x-text="modal.user.age"></span> Ø³Ù†Ø©</div>
            </div>
            <div x-show="modal.edit" class="space-y-3">
                <input type="text" x-model="modal.user.name" placeholder="Ø§Ù„Ø§Ø³Ù…" class="input input-bordered w-full">
                <input type="email" x-model="modal.user.email" placeholder="Ø§Ù„Ø¨Ø±ÙŠØ¯" class="input input-bordered w-full">
                <input type="number" x-model="modal.user.age" placeholder="Ø§Ù„Ø¹Ù…Ø±" class="input input-bordered w-full">
            </div>
            <div class="flex gap-2 mt-4 justify-end">
                <button @click="closeModal()" class="btn btn-ghost">Ø¥ØºÙ„Ø§Ù‚</button>
                <button x-show="!modal.edit" @click="editUser(modal.user)" class="btn btn-warning">ØªØ¹Ø¯ÙŠÙ„</button>
                <button x-show="modal.edit" @click="saveUser()" class="btn btn-primary">Ø­ÙØ¸</button>
            </div>
        </div>
    </div>
</template>

<script>
function app() {
    return {
        users: [],
        newUser: { name: '', email: '', age: '', photo: null, preview: null },
        search: '',
        theme: 'light',
        alert: { show: false, message: '', type: 'success' },
        modal: { show: false, user: {}, edit: false, title: '' },

        init() {
            this.loadTheme();
            this.users = [

            ];
        },

        loadTheme() {
            document.documentElement.setAttribute('data-theme', this.theme);
        },

        toggleTheme() {
            this.theme = this.theme === 'light' ? 'dark' : 'light';
            this.loadTheme();
        },

        handlePhoto(e, mode) {
            const file = e.target.files[0];
            if (!file || !file.type.startsWith('image/')) {
                this.showAlert('âš ï¸ Ø§Ø®ØªØ± ØµÙˆØ±Ø© ØµØ§Ù„Ø­Ø©!', 'error');
                return;
            }
            if (file.size > 5 * 1024 * 1024) {
                this.showAlert('âš ï¸ Ø­Ø¬Ù… Ø§Ù„ØµÙˆØ±Ø© ÙƒØ¨ÙŠØ± Ø¬Ø¯Ø§Ù‹!', 'error');
                return;
            }
            const reader = new FileReader();
            reader.onload = (e) => {
                const data = e.target.result;
                if (mode === 'new') {
                    this.newUser.photo = data;
                    this.newUser.preview = data;
                } else if (mode === 'edit') {
                    this.modal.user.photo = data;
                    this.modal.user.preview = data;
                }
            };
            reader.readAsDataURL(file);
        },

        async addUser() {
            if (!this.newUser.name.trim() || !this.newUser.email.trim() || !this.newUser.age) {
                this.showAlert('âš ï¸ Ø§Ù…Ù„Ø£ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„!', 'error');
                return;
            }
            const id = this.users.length > 0 ? Math.max(...this.users.map(u => u.id)) + 1 : 1;
            this.users.push({ id, ...this.newUser });
            this.showAlert('âœ… ØªÙ…Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ© Ø¨Ù†Ø¬Ø§Ø­!', 'success');
            this.newUser = { name: '', email: '', age: '', photo: null, preview: null };
        },

        viewUser(user) {
            this.modal = { show: true, user: { ...user }, edit: false, title: user.name };
        },

        editUser(user) {
            this.modal = { show: true, user: { ...user, preview: user.photo }, edit: true, title: 'ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…' };
        },

        async saveUser() {
            if (!this.modal.user.name.trim() || !this.modal.user.email.trim() || !this.modal.user.age) {
                this.showAlert('âš ï¸ Ø§Ù…Ù„Ø£ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„!', 'error');
                return;
            }
            const idx = this.users.findIndex(u => u.id === this.modal.user.id);
            if (idx !== -1) {
                this.users[idx] = { ...this.modal.user };
            }
            this.showAlert('âœ… ØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø¨Ù†Ø¬Ø§Ø­!', 'success');
            this.closeModal();
        },

        deleteUser(id) {
            if (confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ØŸ')) {
                this.users = this.users.filter(u => u.id !== id);
                this.showAlert('âœ… ØªÙ… Ø§Ù„Ø­Ø°Ù Ø¨Ù†Ø¬Ø§Ø­!', 'success');
            }
        },

        filtered() {
            if (!this.search) return this.users;
            const s = this.search.toLowerCase();
            return this.users.filter(u => u.name.toLowerCase().includes(s) || u.email.toLowerCase().includes(s));
        },

        closeModal() {
            this.modal.show = false;
        },

        showAlert(msg, type = 'success') {
            this.alert = { show: true, message: msg, type };
            setTimeout(() => this.alert.show = false, 3000);
        }
    }
}
</script>
</body>
</html>
